<%= form_with(model: bet, class: "contents") do |form| %>
  <% if bet.errors.any? %>
    <div id="error_explanation" class="bg-red-50 text-red-500 px-3 py-2 font-medium rounded-md mt-3">
      <h2><%= pluralize(bet.errors.count, "error") %> prohibited this bet from being saved:</h2>
      <ul class="list-disc ml-6">
        <% bet.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <!-- Hidden fields -->
  <%= form.hidden_field :user_id, value: current_user.id %>
  <%= form.hidden_field :race_id, value: bet.race_id || params[:race_id] %>

  <h2 class="font-semibold text-xl mt-5 mb-2">Bet Positions</h2>
  <div class="space-y-3">
    <%= form.fields_for :bet_positions do |bp| %>
      <div class="flex gap-3 items-center">
        <%= bp.number_field :position, in: 1..10, placeholder: "Pos", class: "w-16 rounded border px-2 py-1" %>
        <%= bp.collection_select :driver_id, Driver.all, :id, :name, { prompt: "Select driver" }, class: "flex-1 rounded border px-2 py-1" %>
      </div>
    <% end %>
  </div>

  <div class="inline mt-4">
    <%= form.submit class: "w-full sm:w-auto rounded-md px-3.5 py-2.5 bg-blue-600 hover:bg-blue-500 text-white inline-block font-medium cursor-pointer" %>
  </div>
<% end %>
